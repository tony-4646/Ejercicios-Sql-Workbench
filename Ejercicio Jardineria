SELECT codigo_oficina, ciudad, pais, region FROM oficina;
SELECT codigo_oficina, nombre, apellido1, puesto FROM empleado ORDER BY codigo_oficina;
SELECT region, AVG(limite_credito) AS avglimite_credito FROM cliente GROUP BY region;

SELECT x.nombre_cliente, CONCAT(y.nombre, ' ', y.apellido1) AS Representante 
FROM cliente x 
JOIN empleado y ON codigo_empleado_rep_ventas = y.codigo_empleado;

SELECT codigo_producto, nombre, cantidad_en_stock FROM producto;

SELECT codigo_producto, nombre, precio_venta 
FROM producto
WHERE precio_venta < (SELECT AVG(precio_venta) FROM producto);

SELECT y.nombre_cliente, x.codigo_pedido, x.estado
FROM pedido x
JOIN cliente y ON x.codigo_cliente = y.codigo_cliente
WHERE estado != 'Entregado';

SELECT gama, COUNT(*) AS gama_producto
FROM product
GROUP BY gama;

SELECT x.nombre_cliente, SUM(pag.total) AS ingresos_totales 
FROM cliente x
JOIN pago pag ON x.codigo_cliente = pag.codigo_cliente
GROUP BY x.nombre_cliente;

SELECT codigo_pedido, fecha_pedido 
FROM pedido
WHERE fecha_pedido BETWEEN '2007-01-01' AND '2008-06-20';

SELECT x.codigo_pedido, y.nombre, x.cantidad, (x.cantidad * x.precio_unidad) AS total
FROM detalle_pedido x
JOIN producto y ON x.codigo_producto = y.codigo_producto
WHERE x.codigo_pedido = 48;


SELECT x.nombre, SUM(y.cantidad) AS total 
FROM detalle_pedido y
JOIN producto x ON y.codigo_producto = x.codigo_producto
GROUP BY x.nombre
ORDER BY total DESC;

SELECT x.codigo_pedido, SUM(x.cantidad * x.precio_unidad) AS total 
FROM detalle_pedido x
GROUP BY x.codigo_pedido
HAVING total > (SELECT AVG(x2.cantidad * x2.precio_unidad) FROM detalle_pedido x2);

SELECT nombre_cliente 
FROM cliente
WHERE codigo_empleado_rep_ventas IS NULL;

SELECT codigo_oficina, COUNT(*) AS total_en_oficinas
FROM empleado
GROUP BY codigo_oficina;

SELECT codigo_cliente,forma_pago,id_transaccion,fecha_pago,total
FROM pago
WHERE forma_pago = 'PayPal';

SELECT MONTH(fecha_pago) AS mes, SUM(total) AS ingresos_totales 
FROM pago
GROUP BY mes;

SELECT x.nombre_cliente, COUNT(y.codigo_pedido) AS total_pedidos 
FROM cliente x
JOIN pedido y ON x.codigo_cliente = y.codigo_cliente
GROUP BY x.nombre_cliente
HAVING total_pedidos > 1;

SELECT x.nombre_cliente, COUNT(y.codigo_pedido) AS pedidos 
FROM cliente x
JOIN pedido y ON x.codigo_cliente = y.codigo_cliente
GROUP BY x.nombre_cliente
HAVING pedidos > 1;

SELECT x.codigo_pedido, y.cantidad_en_stock 
FROM detalle_pedido x
JOIN producto y ON x.codigo_producto = y.codigo_producto
WHERE y.cantidad_en_stock =0;
SELECT pais, AVG(limite_credito) AS promedio, MAX(limite_credito) AS max, MIN(limite_credito) AS min
FROM cliente
GROUP BY pais;

SELECT fecha_pago, total, forma_pago 
FROM pago
WHERE codigo_cliente = 38;

SELECT nombre, apellido1, codigo_jefe
FROM empleado
WHERE codigo_jefe IS NULL;

SELECT codigo_producto, nombre, gama, precio_venta 
FROM producto x
WHERE precio_venta > (SELECT AVG(precio_venta) FROM producto x2 WHERE x2.gama = x.gama);

SELECT estado, AVG(DATEDIFF(fecha_entrega, fecha_pedido)) AS promedio
FROM pedido
WHERE fecha_entrega IS NOT NULL
GROUP BY estado;

SELECT pais, COUNT(DISTINCT c.codigo_cliente) AS clientes_con_multiples_pedidos 
FROM cliente c
JOIN pedido p ON c.codigo_cliente = p.codigo_cliente
GROUP BY país
HAVING clientes_con_multiples_pedidos > 1;

SELECT pais, COUNT(DISTINCT x.codigo_cliente) AS clientes_multiples_pedidos 
FROM cliente x
JOIN pedido y ON x.codigo_cliente = y.codigo_cliente
GROUP BY país
HAVING clientes_con_multiples_pedidos > 1;
